<?php
/**
 * @category   PHPExcel
 * @package	PHPExcel_Style
 * @copyright  Copyright (c) 2006 - 2012 PHPExcel (http://www.codeplex.com/PHPExcel)
 * @license	http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt	LGPL
 * @version	1.7.7, 2012-05-19
 */

class PHPExcel_Style_Fill{const FILL_NONE='none';const FILL_SOLID='solid';const FILL_GRADIENT_LINEAR='linear';const FILL_GRADIENT_PATH='path';const FILL_PATTERN_DARKDOWN='darkDown';const FILL_PATTERN_DARKGRAY='darkGray';const FILL_PATTERN_DARKGRID='darkGrid';const FILL_PATTERN_DARKHORIZONTAL='darkHorizontal';const FILL_PATTERN_DARKTRELLIS='darkTrellis';const FILL_PATTERN_DARKUP='darkUp';const FILL_PATTERN_DARKVERTICAL='darkVertical';const FILL_PATTERN_GRAY0625='gray0625';const FILL_PATTERN_GRAY125='gray125';const FILL_PATTERN_LIGHTDOWN='lightDown';const FILL_PATTERN_LIGHTGRAY='lightGray';const FILL_PATTERN_LIGHTGRID='lightGrid';const FILL_PATTERN_LIGHTHORIZONTAL='lightHorizontal';const FILL_PATTERN_LIGHTTRELLIS='lightTrellis';const FILL_PATTERN_LIGHTUP='lightUp';const FILL_PATTERN_LIGHTVERTICAL='lightVertical';const FILL_PATTERN_MEDIUMGRAY='mediumGray';private $_fillType=PHPExcel_Style_Fill::FILL_NONE;private $_rotation=0;private $_startColor;private $_endColor;private $_parentPropertyName;private $_isSupervisor;private $_parent;public function __construct($isSupervisor=false){$this->_isSupervisor=$isSupervisor;$this->_startColor=new PHPExcel_Style_Color(PHPExcel_Style_Color::COLOR_WHITE,$isSupervisor);$this->_endColor=new PHPExcel_Style_Color(PHPExcel_Style_Color::COLOR_BLACK,$isSupervisor);if($isSupervisor){$this->_startColor->bindParent($this,'_startColor');$this->_endColor->bindParent($this,'_endColor');}}public function bindParent($parent){$this->_parent=$parent;return $this;}public function getIsSupervisor(){return $this->_isSupervisor;}public function getSharedComponent(){return $this->_parent->getSharedComponent()->getFill();}public function getActiveSheet(){return $this->_parent->getActiveSheet();}public function getSelectedCells(){return $this->getActiveSheet()->getSelectedCells();}public function getActiveCell(){return $this->getActiveSheet()->getActiveCell();}public function getStyleArray($array){return array('fill'=>$array);}public function applyFromArray($pStyles=null){if(is_array($pStyles)){if($this->_isSupervisor){$this->getActiveSheet()->getStyle($this->getSelectedCells())->applyFromArray($this->getStyleArray($pStyles));}else{if(array_key_exists('type',$pStyles)){$this->setFillType($pStyles['type']);}if(array_key_exists('rotation',$pStyles)){$this->setRotation($pStyles['rotation']);}if(array_key_exists('startcolor',$pStyles)){$this->getStartColor()->applyFromArray($pStyles['startcolor']);}if(array_key_exists('endcolor',$pStyles)){$this->getEndColor()->applyFromArray($pStyles['endcolor']);}if(array_key_exists('color',$pStyles)){$this->getStartColor()->applyFromArray($pStyles['color']);}}}else{throw new Exception("Invalid style array passed.");}return $this;}public function getFillType(){if($this->_isSupervisor){return $this->getSharedComponent()->getFillType();}return $this->_fillType;}public function setFillType($pValue=PHPExcel_Style_Fill::FILL_NONE){if($this->_isSupervisor){$styleArray=$this->getStyleArray(array('type'=>$pValue));$this->getActiveSheet()->getStyle($this->getSelectedCells())->applyFromArray($styleArray);}else{$this->_fillType=$pValue;}return $this;}public function getRotation(){if($this->_isSupervisor){return $this->getSharedComponent()->getRotation();}return $this->_rotation;}public function setRotation($pValue=0){if($this->_isSupervisor){$styleArray=$this->getStyleArray(array('rotation'=>$pValue));$this->getActiveSheet()->getStyle($this->getSelectedCells())->applyFromArray($styleArray);}else{$this->_rotation=$pValue;}return $this;}public function getStartColor(){return $this->_startColor;}public function setStartColor(PHPExcel_Style_Color $pValue=null){$color=$pValue->getIsSupervisor()?$pValue->getSharedComponent():$pValue;if($this->_isSupervisor){$styleArray=$this->getStartColor()->getStyleArray(array('argb'=>$color->getARGB()));$this->getActiveSheet()->getStyle($this->getSelectedCells())->applyFromArray($styleArray);}else{$this->_startColor=$color;}return $this;}public function getEndColor(){return $this->_endColor;}public function setEndColor(PHPExcel_Style_Color $pValue=null){$color=$pValue->getIsSupervisor()?$pValue->getSharedComponent():$pValue;if($this->_isSupervisor){$styleArray=$this->getEndColor()->getStyleArray(array('argb'=>$color->getARGB()));$this->getActiveSheet()->getStyle($this->getSelectedCells())->applyFromArray($styleArray);}else{$this->_endColor=$color;}return $this;}public function getHashCode(){if($this->_isSupervisor){return $this->getSharedComponent()->getHashCode();}return md5($this->getFillType().$this->getRotation().$this->getStartColor()->getHashCode().$this->getEndColor()->getHashCode().__CLASS__);}public function __clone(){$vars=get_object_vars($this);foreach($vars as $key=>$value){if((is_object($value))&&($key!='_parent')){$this->$key=clone $value;}else{$this->$key=$value;}}}}